<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Pomodoro 통계</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; }
        .chart-container { width: 80%; margin-bottom: 40px; }
    </style>
</head>
<body>
    <h1>Pomodoro 집중 통계</h1>

    <div class="chart-container">
        <h2>일별 집중도</h2>
        <canvas id="dailyFocusChart"></canvas>
    </div>

    <div class="chart-container">
        <h2>가장 많이 수행한 작업 유형</h2>
        <canvas id="taskTypesChart"></canvas>
    </div>

    <div class="chart-container">
        <h2>가장 많이 사용한 포모도로 세팅</h2>
        <canvas id="pomodoroSettingsChart"></canvas>
    </div>

    <script>
        // Flask에서 전달받은 통계 데이터
        const dailyFocusChartData = JSON.parse('{{ daily_focus_chart_data | tojson | safe }}');
        const taskTypesChartData = JSON.parse('{{ task_types_chart_data | tojson| safe }}');
        const pomodoroSettingsChartData = JSON.parse('{{ pomodoro_settings_chart_data | tojson | safe }}');

        // 일별 집중도 차트
        const dailyFocusCtx = document.getElementById('dailyFocusChart').getContext('2d');
        new Chart(dailyFocusCtx, {
            type: 'bar', // 또는 'line'
            data: {
                labels: dailyFocusChartData.labels,
                datasets: dailyFocusChartData.datasets.map(dataset => ({
                    label: dataset.label,
                    data: dataset.data,
                    backgroundColor: `rgba(${Math.floor(Math.random() * 255)}, ${Math.floor(Math.random() * 255)}, ${Math.floor(Math.random() * 255)}, 0.5)`, // 임의 색상
                    borderColor: `rgba(${Math.floor(Math.random() * 255)}, ${Math.floor(Math.random() * 255)}, ${Math.floor(Math.random() * 255)}, 1)`,
                    borderWidth: 1
                }))
            },
            options: {
                responsive: true,
                scales: {
                    y: { beginAtZero: true, precision: 0 }
                }
            }
        });

        // 작업 유형 차트 (파이 차트)
        const taskTypesCtx = document.getElementById('taskTypesChart').getContext('2d');
        new Chart(taskTypesCtx, {
            type: 'pie',
            data: {
                labels: taskTypesChartData.labels,
                datasets: [{
                    data: taskTypesChartData.data,
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.5)',
                        'rgba(54, 162, 235, 0.5)',
                        'rgba(255, 206, 86, 0.5)',
                        'rgba(75, 192, 192, 0.5)',
                        'rgba(153, 102, 255, 0.5)',
                        'rgba(255, 159, 64, 0.5)'
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
            }
        });

        // 포모도로 세팅 차트 (막대 차트)
        const pomodoroSettingsCtx = document.getElementById('pomodoroSettingsChart').getContext('2d');
        new Chart(pomodoroSettingsCtx, {
            type: 'bar',
            data: {
                labels: pomodoroSettingsChartData.labels,
                datasets: [{
                    label: '사용 횟수',
                    data: pomodoroSettingsChartData.data,
                    backgroundColor: 'rgba(54, 162, 235, 0.5)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: { beginAtZero: true, precision: 0 }
                }
            }
        });
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Pomodoro 통계</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #fdfdfd;
        }
        .chart-container {
            width: 80%;
            margin-bottom: 40px;
        }
       .button-container {
    width: 100%;
    display: flex;
    justify-content: center; /* 중앙 정렬 */
    margin-top: 20px;
    margin-bottom: 40px;
}

.btn-home {
    padding: 12px 24px;
    background-color: #6c63ff;
    color: white;
    text-decoration: none;
    font-size: 16px;
    border-radius: 8px;
    box-shadow: 0 6px 0 #4b42b3, 0 8px 15px rgba(0, 0, 0, 0.1);
    transition: all 0.2s ease;
    position: relative;
    top: 0;
}

.btn-home:hover {
    background-color: #5751d1;
}

.btn-home:active {
    top: 3px;
    box-shadow: 0 3px 0 #4b42b3, 0 4px 10px rgba(0, 0, 0, 0.15);
}
    </style>
</head>
<body>
    <h1>Pomodoro 집중 통계</h1>

    <div class="chart-container">
        <h2>일별 집중도</h2>
        <canvas id="dailyFocusChart"></canvas>
    </div>

    <div class="chart-container">
        <h2>가장 많이 수행한 작업 유형</h2>
        <canvas id="taskTypesChart"></canvas>
    </div>

    <div class="chart-container">
        <h2>가장 많이 사용한 포모도로 세팅</h2>
        <canvas id="pomodoroSettingsChart"></canvas>
    </div>

    <!-- ✅ 처음으로 버튼 -->
    <div class="button-container">
        <a href="/" class="btn-home">처음으로</a>
    </div>

    <script>
        const dailyFocusChartData = JSON.parse('{{ daily_focus_chart_data | tojson | safe }}');
        const taskTypesChartData = JSON.parse('{{ task_types_chart_data | tojson| safe }}');
        const pomodoroSettingsChartData = JSON.parse('{{ pomodoro_settings_chart_data | tojson | safe }}');

        const dailyFocusCtx = document.getElementById('dailyFocusChart').getContext('2d');
        new Chart(dailyFocusCtx, {
            type: 'bar',
            data: {
                labels: dailyFocusChartData.labels,
                datasets: dailyFocusChartData.datasets.map(dataset => ({
                    label: dataset.label,
                    data: dataset.data,
                    backgroundColor: `rgba(${Math.floor(Math.random() * 255)}, ${Math.floor(Math.random() * 255)}, ${Math.floor(Math.random() * 255)}, 0.5)`,
                    borderColor: `rgba(${Math.floor(Math.random() * 255)}, ${Math.floor(Math.random() * 255)}, ${Math.floor(Math.random() * 255)}, 1)`,
                    borderWidth: 1
                }))
            },
            options: {
                responsive: true,
                scales: {
                    y: { beginAtZero: true, precision: 0 }
                }
            }
        });

        const taskTypesCtx = document.getElementById('taskTypesChart').getContext('2d');
        new Chart(taskTypesCtx, {
            type: 'pie',
            data: {
                labels: taskTypesChartData.labels,
                datasets: [{
                    data: taskTypesChartData.data,
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.5)',
                        'rgba(54, 162, 235, 0.5)',
                        'rgba(255, 206, 86, 0.5)',
                        'rgba(75, 192, 192, 0.5)',
                        'rgba(153, 102, 255, 0.5)',
                        'rgba(255, 159, 64, 0.5)'
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
            }
        });

        const pomodoroSettingsCtx = document.getElementById('pomodoroSettingsChart').getContext('2d');
        new Chart(pomodoroSettingsCtx, {
            type: 'bar',
            data: {
                labels: pomodoroSettingsChartData.labels,
                datasets: [{
                    label: '사용 횟수',
                    data: pomodoroSettingsChartData.data,
                    backgroundColor: 'rgba(54, 162, 235, 0.5)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: { beginAtZero: true, precision: 0 }
                }
            }
        });
    </script>
</body>
</html>
